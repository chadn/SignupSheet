{% extends 'base.html' %}
{% load coordinator %}

{% block sitenav %}
{% include 'sitenav.html' %}
{% endblock %}

{% block content %}	
	{% is_coord as is_coordinator %}
	<div class="row">
	<div class="col-md-3">
		<nav>
			<!-- For mid-size and larger devices, render as a sidebar -->
			<div class="visible-md-block visible-lg-block visible-xl-block">
				<ul class="list-group">
				{% for r in roles %}
					{% if is_coordinator or r.status == 1 %}
						<li class="list-group-item"><a href="{% url "jobs" title=r.source.pk %}">{{r.source.pk}}</a>
						</li>
					{% endif %}
				{% endfor %}
				{% for r in roles %}
					{% if is_coordinator or r.status == 0 %}
						<li class="list-group-item"><i>{{r.source.pk}} Temporarily Disabled</i>
						</li>
					{% endif %}
				{% endfor %}
				</ul>
			</div>
			<!-- for phones small devices, render as a pulldown -->
			<div class="visible-sm-block visible-xs-block">
				<ul class="nav">
					<li role="presentation" class="dropdown">
						<a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">
			      			Choose a Job<span class="caret"></span>
	    				</a>
						<ul class="dropdown-menu">
						{% for r in roles %}
							{% if is_coordinator or r.status == 1 %}
								<li class="list-group-item"><a href="{% url "jobs" title=r.source.pk %}">{{r.source.pk}}</a>
								</li>
							{% endif %}
						{% endfor %}
						{% for r in roles %}
							{% if is_coordinator or r.status == 0 %}
								<li class="list-group-item"><i>{{r.source.pk}} Temporarily Disabled</i>
								</li>
							{% endif %}
						{% endfor %}
						</ul>
					</li>
				</ul>
			</div>
		<nav>		
	</div>

	<div class="col-md-9">	
		<div class="roleheader">
			<h1>{{ role.source.pk }}</h1>
			{% if enabled == 1 %} 
				{% if role.status == 1 %}
					{% if needed > 0 %}
						<i>There are {{ needed }} shifts available of a total of {{ total }} needed.</i>
					{% else %}
						<i>All {{total}} available shifts are taken!</i>
					{% endif %}
				{% else %}
					<span style='color: red;'>
					<i>Signups for this job have been temporarily disabled.</i>
					</span>
				{% endif %}
			{% else %}
				<span style='color: red;'>
				<i>The staff sheet is not yet enabled for general signups.<br/>
				If you're a coordinator you will be able to fill your protected jobs.<br/>
				Otherwise please wait for an announcement indicating the general availability of the staff sheet.
				</i>
				</span>
			{% endif %} 				
			<h3>Coordinators</h3>
			<div class="coordinators">
				<div class="coordinator-pics">
					{% for coordinator in coordinators %}
  					  <img src="{{coordinator.url}}"></img>
					{% endfor %}	
				</div>
				<div class="coordinator-names">
				{% for coordinator in coordinators %}
  				  	{{ coordinator.name }}{% if not forloop.last %}, {%endif%} 
				{% endfor %}		
				</div>
			</div>
			<h3>Description</h3>
			<div class="roledescription">
				{% if role.contact != '' %}
					<p><b>Contact: {{ role.contact }}</b></p>
				{% endif %}
				{{ role.description | safe }}
			</div>
			
		</div>
		
		<div class="jobslist">
		{% for job in jobs %} 
			<h3>{{ job.job.title }}</h3>
			<span class="jobtimes">{{ job.job.start | date:"l P" }} to {{ job.job.end | date:"l P" }}</span>
			<div class="job">
				{% if job.needed > 0 %}
					{% if role.contact != '' %}
						<a href="mailto:{{role.contact}}?subject={{job.job.title |urlencode}}%20Shift%20{{ job.job.start | date:"l P" | urlencode}}" target="_blank">
					{% endif %}
					{% if job.job.protected %}
						<i>Please contact the coordinator to sign up for this job.</i><br>
					{% endif %}
					{% if role.contact != '' %}
						</a>
					{% endif %}
				{% endif %}
				<span class="jobdescription">{{ job.job.description | safe }}</span>
				<div class="jobpeople">
					<table class="table table-striped">
					{% for volunteer in job.volunteers %} 
						<tr>
						<td>{{ forloop.counter }}</td>
						<td>
						{% if volunteer.volunteer != None %}
							{{ volunteer.volunteer.name | title}} 
							{% if volunteer.volunteer.comment != "" %}
								<span class="volunteercomment">{{ volunteer.volunteer.comment }}</span>
							{% endif %}
							{% if volunteer.can_delete != None %}
								<a href='javascript:void(0)' onclick='popup_click("{% url "delete" pk=volunteer.can_delete %}");'>(delete)</a>
							{% endif %}
						{% endif %}							
						</td>
						</tr>
					{% endfor %}
					</table>								
					{% if job.can_signup %}	
						<button onclick='popup_click("{% url "signup" pk=job.job.pk %}");'>Signup</button>
					{% endif %}					
				</div>

			</div>		
		{% endfor %}
		</div>
		
	</div> <!-- end of the selection column -->

	{% include "popupform.html" %}		
{% endblock %}


