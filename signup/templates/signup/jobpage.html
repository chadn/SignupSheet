{% extends 'base.html' %}
{% load coordinator %}
{% load staticfiles %}

{% block sitenav %}
{% include 'sitenav.html' %}
{% endblock %}

{% block content %}	
	{% is_coord as is_coordinator %}
	<div class="row">
	<div class="col-md-3">
		<nav>
			<!-- For mid-size and larger devices, render as a sidebar -->
			<div class="visible-md-block visible-lg-block visible-xl-block">
				<ul class="list-group">
				{% for r in navdata %}
					{% if is_coordinator or r.role.status == 1 %}
						<li class="list-group-item">
							<img title="{{r.alt}}" src="{% static r.pic %}" height=20></img>
							<a href="{% url "jobs" title=r.role.source.pk %}">{{r.role.source.pk}}</a>
							<br/><small>{{r.needed}} volunteer(s) needed</small>
						</li>
					{% endif %}
				{% endfor %}
				{% if not is_coordinator %}
					{% for r in navdata %}
						{% if is_coordinator or r.role.status == 0 %}
							<li class="list-group-item"><a href="{% url "jobs" title=r.role.source.pk %}">{{r.role.source.pk}}</a>
							<br/><i>Temporarily Disabled</i>
							</li>
						{% endif %}
					{% endfor %}
				{% endif %}
				</ul>
			</div>
			<!-- for phones small devices, render as a pulldown -->
			<div class="visible-sm-block visible-xs-block">
				<ul class="nav">
					<li role="presentation" class="dropdown">
						<a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">
			      			Choose a Job<span class="caret"></span>
	    				</a>
						<ul class="dropdown-menu">
						{% for r in navdata %}
							{% if is_coordinator or r.role.status == 1 %}
								<li class="list-group-item">
									<a href="{% url "jobs" title=r.role.source.pk %}">
										<img src="{% static r.pic %}" height=15></img>
										{{r.role.source.pk}}
										<br/><small>{{r.needed}} volunteer(s) needed</small>
									</a>
								</li>
							{% endif %}
						{% endfor %}
						{% if not is_coordinator %}
							{% for r in navdata %}
								{% if is_coordinator or r.role.status == 0 %}
									<li class="list-group-item">
									<i>Disabled:</i>
									<a href="{% url "jobs" title=r.role.source.pk %}">{{r.role.source.pk}}</a>
									</li>
								{% endif %}
							{% endfor %}
						{% endif %}
						</ul>
					</li>
				</ul>
			</div>
		<nav>		
	</div>

	<div class="col-md-9">	
		<div class="roleheader">
			<div class="title"> 
  			    <h1 style="display: inline;">{{ role.source.pk }}</h1>
  			    {% if coordinator_of %}
	  	  			[<a href="{% url "source_update" role.source.pk%}?next={{role.source.pk}}">edit</a>]
  	  			{% endif %}
			</div>
			<span style='color: {{ status.color }};'>
				<i>{{ status.text | safe}}</i>
			</span>
			<h3>Coordinators</h3>
			<div class="coordinators">
				<div class="coordinator-pics">
					{% for coordinator in coordinators %}
  					  <img src="{{coordinator.url}}"></img>
					{% endfor %}	
				</div>
				<div class="coordinator-names">
				{% for coordinator in coordinators %}
  				  	{{ coordinator.name }}{% if not forloop.last %}, {%endif%} 
				{% endfor %}		
				</div>
			</div>
			<h3>Description</h3>
			<div class="roledescription">
				{% if role.contact != '' %}
					<p><b>Contact: {{ role.contact }}</b></p>
				{% endif %}
				{{ role.description | safe }}
			</div>
			
		</div>
		
		<div class="jobslist">
		{% for job in jobs %} 
			<h3>{{ job.job.title }}</h3>
			<span class="jobtimes">{{ job.job.start | date:"l P" }} to {{ job.job.end | date:"l P" }}</span>
			<div class="job">
				{% if job.needed > 0 %}
					{% if role.contact != '' %}
						<a href="mailto:{{role.contact}}?subject={{job.job.title |urlencode}}%20Shift%20{{ job.job.start | date:"l P" | urlencode}}" target="_blank">
					{% endif %}
					{% if job.job.protected %}
						<i>Please contact the coordinator to sign up for this job.</i><br>
					{% endif %}
					{% if role.contact != '' %}
						</a>
					{% endif %}
				{% endif %}
				<span class="jobdescription">{{ job.job.description | safe }}</span>
				<div class="jobpeople">
					<table class="table table-striped">
					{% for volunteer in job.volunteers %} 
						<tr>
						<td>{{ forloop.counter }}</td>
						<td>
						{% if volunteer.volunteer != None %}
							{{ volunteer.volunteer.name | title}} 
							{% if volunteer.volunteer.comment != "" %}
								<span class="volunteercomment">{{ volunteer.volunteer.comment }}</span>
							{% endif %}
							{% if volunteer.can_delete != None %}
								<a href='javascript:void(0)' onclick='popup_click("{% url "delete" pk=volunteer.can_delete %}");'>(delete)</a>
							{% endif %}
						{% endif %}							
						</td>
						</tr>
					{% endfor %}
					</table>								
					{% if job.can_signup %}	
						<button onclick='popup_click("{% url "signup" pk=job.job.pk %}");'>Signup</button>
					{% endif %}					
				</div>

			</div>		
		{% endfor %}
		</div>
		
	</div> <!-- end of the selection column -->

	{% include "popupform.html" %}		
{% endblock %}


